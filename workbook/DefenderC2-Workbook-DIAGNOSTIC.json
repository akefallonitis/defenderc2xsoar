{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "# ⚠️ DIAGNOSTIC WORKBOOK\n\n## Parameter Test\n\nThis workbook will show you the actual values of each parameter."
      }
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "function-app",
            "version": "KqlParameterItem/1.0",
            "name": "FunctionApp",
            "label": "DefenderC2 Function App",
            "type": 5,
            "isRequired": true,
            "isGlobal": true,
            "query": "Resources | where type == 'microsoft.web/sites' and kind == 'functionapp' | project id, name, resourceGroup, subscriptionId",
            "crossComponentResources": ["value::all"],
            "typeSettings": {
              "additionalResourceOptions": ["value::1"],
              "showDefault": false
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "subscription-id",
            "version": "KqlParameterItem/1.0",
            "name": "Subscription",
            "type": 1,
            "isRequired": true,
            "isGlobal": true,
            "query": "Resources | where id == '{FunctionApp}' | project value = subscriptionId",
            "crossComponentResources": ["value::all"],
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "criteriaData": [
              {"criterionType": "param", "value": "{FunctionApp}"}
            ]
          },
          {
            "id": "resource-group",
            "version": "KqlParameterItem/1.0",
            "name": "ResourceGroup",
            "type": 1,
            "isRequired": true,
            "isGlobal": true,
            "query": "Resources | where id == '{FunctionApp}' | project value = resourceGroup",
            "crossComponentResources": ["value::all"],
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "criteriaData": [
              {"criterionType": "param", "value": "{FunctionApp}"}
            ]
          },
          {
            "id": "function-name",
            "version": "KqlParameterItem/1.0",
            "name": "FunctionAppName",
            "type": 1,
            "isRequired": true,
            "isGlobal": true,
            "query": "Resources | where id == '{FunctionApp}' | project value = name",
            "crossComponentResources": ["value::all"],
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "criteriaData": [
              {"criterionType": "param", "value": "{FunctionApp}"}
            ]
          }
        ],
        "style": "pills",
        "queryType": 1,
        "resourceType": "microsoft.resourcegraph/resources"
      }
    },
    {
      "type": 1,
      "content": {
        "json": "---\n\n## Parameter Values\n\n**FunctionApp**: `{FunctionApp}`\n\n**Subscription**: `{Subscription}`\n\n**ResourceGroup**: `{ResourceGroup}`\n\n**FunctionAppName**: `{FunctionAppName}`\n\n---\n\n### What you should see:\n- FunctionApp: Full resource ID\n- Subscription: GUID (no `<unset>`)\n- ResourceGroup: Name like `alex-testing-rg`\n- FunctionAppName: Name like `defenderc2`\n\nIf any show `<unset>`, the parameter query is wrong."
      }
    }
  ],
  "fallbackResourceIds": ["Azure Monitor"],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
